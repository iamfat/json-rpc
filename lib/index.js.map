{"version":3,"file":"index.js","sources":["../node_modules/hash-sum/hash-sum.js","../src/rpc.ts","../src/index.ts"],"sourcesContent":["'use strict';\n\nfunction pad (hash, len) {\n  while (hash.length < len) {\n    hash = '0' + hash;\n  }\n  return hash;\n}\n\nfunction fold (hash, text) {\n  var i;\n  var chr;\n  var len;\n  if (text.length === 0) {\n    return hash;\n  }\n  for (i = 0, len = text.length; i < len; i++) {\n    chr = text.charCodeAt(i);\n    hash = ((hash << 5) - hash) + chr;\n    hash |= 0;\n  }\n  return hash < 0 ? hash * -2 : hash;\n}\n\nfunction foldObject (hash, o, seen) {\n  return Object.keys(o).sort().reduce(foldKey, hash);\n  function foldKey (hash, key) {\n    return foldValue(hash, o[key], key, seen);\n  }\n}\n\nfunction foldValue (input, value, key, seen) {\n  var hash = fold(fold(fold(input, key), toString(value)), typeof value);\n  if (value === null) {\n    return fold(hash, 'null');\n  }\n  if (value === undefined) {\n    return fold(hash, 'undefined');\n  }\n  if (typeof value === 'object' || typeof value === 'function') {\n    if (seen.indexOf(value) !== -1) {\n      return fold(hash, '[Circular]' + key);\n    }\n    seen.push(value);\n\n    var objHash = foldObject(hash, value, seen)\n\n    if (!('valueOf' in value) || typeof value.valueOf !== 'function') {\n      return objHash;\n    }\n\n    try {\n      return fold(objHash, String(value.valueOf()))\n    } catch (err) {\n      return fold(objHash, '[valueOf exception]' + (err.stack || err.message))\n    }\n  }\n  return fold(hash, value.toString());\n}\n\nfunction toString (o) {\n  return Object.prototype.toString.call(o);\n}\n\nfunction sum (o) {\n  return pad(foldValue(0, o, '', []).toString(16), 8);\n}\n\nmodule.exports = sum;\n",null,null],"names":["fold","hash","text","i","len","length","charCodeAt","foldValue","input","value","key","seen","o","Object","prototype","toString","call","undefined","indexOf","push","objHash","keys","sort","reduce","foldObject","valueOf","String","err","stack","message","pad","nanoid","alphabet","size","id","Math","random","RPCError","Error","[object Object]","code","super","this","RPC","send","options","_options","timeout","on","params","_hashedFunctions","hasOwnProperty","f","Promise","resolve","remoteId","path","obj","_remoteObjects","props","split","lastProp","pop","p","Reflect","get","set","e","console","debug","then","JSON","parse","stringify","catch","passToRemote","slice","apply","ret","makeRemoteObject","_remoteObjectClusters","map","self","_decode","param","has","Proxy","target","prop","sProp","notify","_","__","k","Array","isArray","bufferDecode","_encode","hash_sum","@func","isBuffer","bufferEncode","uniqid","rootId","cluster","@remote","rpc","extendedRPCs","method","_callingHandlers","handler","once","callback","_patterns","matches","match","pattern","request","sendError","jsonrpc","remote","getHandler","decodeNonScalars","result","sendResult","_promises","promise","reject","error","clearTimeout","RemoteObjectHandler","propName","$$baseName","$$cache","assign","release$","forEach","get$","data","encodeNonScalars","setTimeout","str","filter","Buffer","s","from"],"mappings":"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"}