{"version":3,"file":"index.js","sources":["../src/rpc.ts","../src/index.ts"],"sourcesContent":[null,null],"names":["RPCError","Error","[object Object]","message","code","super","this","RPC","send","options","_options","timeout","on","hash","params","_hashedFunctions","hasOwnProperty","f","Promise","resolve","remoteId","path","value","obj","_remoteObjects","props","split","lastProp","pop","o","p","Reflect","get","set","e","console","debug","then","JSON","parse","stringify","catch","passToRemote","slice","apply","ret","makeRemoteObject","_remoteObjectClusters","map","key","self","_decode","param","Object","has","Proxy","target","prop","sProp","String","notify","_","__","k","Array","isArray","bufferDecode","_encode","hash_sum","@func","isBuffer","bufferEncode","uniqid","nanoid","rootId","cluster","push","@remote","rpc","extendedRPCs","method","_callingHandlers","handler","once","callback","_patterns","matches","match","pattern","undefined","request","sendError","jsonrpc","remote","getHandler","length","id","decodeNonScalars","result","sendResult","_promises","promise","reject","error","clearTimeout","RemoteObjectHandler","propName","$$baseName","call","$$cache","assign","release$","keys","forEach","get$","data","encodeNonScalars","setTimeout","str","toString","filter","Buffer","s","from"],"mappings":"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"}