{"version":3,"file":"index.mjs","sources":["../src/rpc.ts","../src/index.ts"],"sourcesContent":[null,null],"names":["hash_sum","require","nanoid","RPCError","Error","[object Object]","message","code","super","this","RPC","send","options","_options","timeout","on","hash","params","_hashedFunctions","hasOwnProperty","f","Promise","resolve","remoteId","path","value","obj","_remoteObjects","props","split","lastProp","pop","o","p","Reflect","get","set","e","console","debug","then","JSON","parse","stringify","catch","passToRemote","slice","apply","ret","makeRemoteObject","_remoteObjectClusters","map","key","self","_decode","param","Object","has","Proxy","target","prop","sProp","String","notify","_","__","k","Array","isArray","bufferDecode","_encode","@func","isBuffer","bufferEncode","uniqid","rootId","cluster","push","@remote","rpc","extendedRPCs","method","_callingHandlers","handler","once","callback","_patterns","matches","match","pattern","undefined","request","sendError","jsonrpc","remote","getHandler","length","id","decodeNonScalars","result","sendResult","_promises","promise","reject","error","clearTimeout","RemoteObjectHandler","propName","$$baseName","call","$$cache","assign","release$","keys","forEach","get$","data","encodeNonScalars","setTimeout","str","toString","filter","Buffer","s","from"],"mappings":"AAAA,MAAMA,EAAWC,QAAQ,aACnBC,OAAEA,GAAWD,QAAQ,2BAEdE,UAAiBC,MAI1BC,YAAmBC,EAAiBC,GAChCC,MAAMF,GACNG,KAAKF,KAAOA,GAAQ,EACpBE,KAAKH,QAAUA,EAGZD,WACH,OAAOI,KAAKH,eAgCPI,EAgBTL,YAAmBM,EAAeC,GAR1BH,eAA8C,GAC9CA,sBAAgF,GAChFA,eAA0B,GAE1BA,sBAAiD,GACjDA,oBAAwC,GACxCA,2BAAoD,GAqJpDA,kBAAsB,GAlJ1BA,KAAKE,KAAOA,EACZF,KAAKI,wBAAaC,QAAS,KAAUF,GAAW,IAEhDH,KAAKM,GAAG,kBAAmB,CAACC,EAAcC,KACtC,GAAIR,KAAKS,iBAAiBC,eAAeH,GAAO,CAC5C,IAAII,EAAIX,KAAKS,iBAAiBF,GAC9B,OAAOK,QAAQC,QAAQF,KAAKH,IAEhC,OAAOI,QAAQC,YAGnBb,KAAKM,GAAG,qBAAuBC,IACvBP,KAAKS,iBAAiBC,eAAeH,WAC9BP,KAAKS,iBAAiBF,KAIrCP,KAAKM,GAAG,qBAAsB,CAACQ,EAAkBC,EAAcC,KAC3D,IACI,MAAMC,EAAMjB,KAAKkB,eAAeJ,GAC1BK,EAAQJ,EAAKK,MAAM,KACnBC,EAAWF,EAAMG,MACvB,IAAIC,EAAIN,EACR,IAAK,IAAIO,KAAKL,EACVI,EAAIE,QAAQC,IAAIH,EAAGC,GAEvBC,QAAQE,IAAIJ,EAAGF,EAAUL,GAC3B,MAAOY,GACLC,QAAQC,MAAMF,MAItB5B,KAAKM,GAAG,qBAAuBQ,IAC3B,MAAMG,EAAMjB,KAAKkB,eAAeJ,GAChC,OAAOF,QAAQC,QAAQI,GAClBc,KAAMR,GACIS,KAAKC,MAAMD,KAAKE,UAAUX,KAEpCY,MAAOP,IACJC,QAAQC,MAAM,2BAA4BF,OAItD5B,KAAKM,GAAG,uBAAwB,CAACQ,EAAkBC,EAAcP,KAC7D,MAAMS,EAAMjB,KAAKkB,eAAeJ,GAChC,IAAIsB,EAAcjB,EACK,MAAnBJ,EAAKsB,OAAO,IACZlB,EAAQJ,EAAKsB,MAAM,GAAI,GAAGjB,MAAM,KAChCgB,GAAe,IAEfjB,EAAQJ,EAAKK,MAAM,KACnBgB,GAAe,GAEnB,MAAMf,EAAWF,EAAMG,MACvB,IAAIC,EAAIN,EACR,IAAK,IAAIO,KAAKL,EACVI,EAAIE,QAAQC,IAAIH,EAAGC,GAEvB,OAAOZ,QAAQC,QAAQY,QAAQa,MAAMf,EAAEF,GAAWE,EAAGf,IAASuB,KAAMQ,GAC5DH,EACOJ,KAAKC,MAAMD,KAAKE,UAAUK,IAE9BvC,KAAKwC,iBAAiBD,EAAKzB,MAI1Cd,KAAKM,GAAG,yBAA2BQ,KACfd,KAAKyC,sBAAsB3B,IAAa,IAChD4B,IAAKC,UAAe3C,KAAKkB,eAAeyB,WACzC3C,KAAKyC,sBAAsB3B,IAC3B,IAIPlB,iBAAiBY,GACrB,MAAMoC,EAAO5C,KAEP6C,EAAWC,IACb,GAAIA,IAAUC,OAAOD,GAAQ,CACzB,GAAuB,QAAnBA,EAAM,UAAsBrB,QAAQuB,IAAIF,EAAO,QAC/C,OAAO,IAAIG,MAAM,OAAU,CACvBrD,IAAIsD,EAAQC,GAER,MAAMC,EAAQC,OAAOF,GACrB,OAAI1B,QAAQuB,IAAIE,EAAQC,GACbD,EAAOC,GAEJ,YAAVC,EACO,KACHR,EAAKU,OAAO,qBAAsB,CAACR,EAAMvC,aAFjD,GAMJX,MAAM2D,EAAGC,EAAIhD,GACToC,EAAKU,OAAO,kBAAmB,CAACR,EAAMvC,KAAMC,OAIpD,IAAK,IAAIiD,KAAKX,EACVA,EAAMW,GAAKZ,EAAQC,EAAMW,QAG9B,CAAA,GAAIC,MAAMC,QAAQb,GACrB,OAAOA,EAAMJ,IAAKlB,GAAMqB,EAAQrB,IAC7B,GAAIvB,EAAI2D,cAAiC,iBAAVd,GAA4C,UAAtBA,EAAMT,MAAM,EAAG,GACvE,OAAOpC,EAAI2D,aAAad,EAAMT,MAAM,IAExC,OAAOS,GAGX,OAAOD,EAAQrC,GAGXZ,iBAAiBY,GACrB,MAAMqD,EAAWf,IACb,GAAqB,mBAAVA,EAAsB,CAC7B,IAAIvC,EAAOhB,EAASuD,GAEpB,OADA9C,KAAKS,iBAAiBF,GAAQuC,EACvB,CAAEgB,QAAS,MAAOvD,KAAAA,GACtB,GAAIN,EAAI8D,UAAY9D,EAAI+D,cAAgB/D,EAAI8D,SAASjB,GACxD,MAAO,QAAU7C,EAAI+D,aAAalB,GAC/B,GAAIY,MAAMC,QAAQb,GACrB,OAAOA,EAAMJ,IAAKlB,GAAMqC,EAAQrC,IAC7B,GAAIuB,OAAOD,KAAWA,EACzB,IAAK,IAAIW,KAAKX,EACVA,EAAMW,GAAKI,EAAQf,EAAMW,IAGjC,OAAOX,GAGX,OAAOe,EAAQrD,GAGXZ,iBAAiBqB,EAAUH,GAC/B,MAAMmD,EAASxE,IACfO,KAAKkB,eAAe+C,GAAUhD,EAE9B,MAAMiD,EAASpD,GAAYmD,EACrBE,EAAUnE,KAAKyC,sBAAsByB,IAAW,GAItD,OAHAC,EAAQC,KAAKH,GACbjE,KAAKyC,sBAAsByB,GAAUC,EAE9B,CAAEE,UAAWJ,GAIjBrE,QAAQ0E,GACXtE,KAAKuE,aAAaH,KAAKE,GAGnB1E,WAAW4E,GACf,GAAIxE,KAAKyE,iBAAiB/D,eAAe8D,GAAS,CAC9C,MAAME,EAAU1E,KAAKyE,iBAAiBD,GAItC,OAHIE,EAAQC,aACD3E,KAAKyE,iBAAiBD,GAE1B,CAACE,EAAQE,UAGpB,IAAK,IAAIpD,KAAKxB,KAAK6E,UAAW,CAC1B,MAAMC,EAAUN,EAAOO,MAAMvD,EAAEwD,SAC/B,GAAIF,EACA,MAAO,CAACtD,EAAEoD,SAAUE,GAG5B,MAAO,MAACG,GAGLrF,QAAQsF,GACX,GAAuB,iBAAZA,EACP,IACIA,EAAUlD,KAAKC,MAAMiD,GACvB,MAAOtD,GAEL,YADA5B,KAAKmF,UAAU,IAAIzF,EAAS,eAAgB,QAKpD,GAAwB,QAApBwF,EAAQE,QAAZ,CAKA,GAAI3D,QAAQuB,IAAIkC,EAAS,UAAW,CAChC,IAGIG,EAHAb,EAASU,EAAQV,OACjBhE,EAAS0E,EAAQ1E,OAGI,MAArBgE,EAAOnC,OAAO,IAEdmC,EAASA,EAAOnC,MAAM,GAAI,GAC1BgD,GAAS,GAETA,GAAS,EAGb,IAAK1E,EAAGmE,GAAgB9E,KAAKsF,WAAWd,GAExC,QAAUS,IAANtE,GAAmBX,KAAKuE,aAAagB,OAAS,EAC9C,IAAK,IAAIjB,KAAOtE,KAAKuE,aAEjB,IADC5D,EAAGmE,GAAWR,EAAIgB,WAAWd,GAC1B7D,EAAG,MAIf,YAAUsE,IAANtE,OACIuE,EAAQM,IACRxF,KAAKmF,UAAU,IAAIzF,EAAS,WAAW8E,gBAAsB,OAAQU,EAAQM,MAKrFhF,EAASR,KAAKyF,iBAAiBjF,GAC1BkD,MAAMC,QAAQnD,KACfA,EAAS,CAACA,IAGVsE,IACAtE,EAAS,CAACA,EAAQsE,IAEflE,QAAQC,QAAQF,KAAKH,IACvBuB,KAAM2D,IACCL,IAEAK,EAAS1F,KAAKwC,iBAAiBkD,IAE/BR,EAAQM,IACRxF,KAAK2F,WAAWD,EAAQR,EAAQM,MAGvCrD,MAAOP,IACJ,KAAIA,aAAalC,GAGb,MAAMkC,EAFN5B,KAAKmF,UAAUvD,EAAGsD,EAAQM,OAKnC,GAAI/D,QAAQuB,IAAIkC,EAAS,UAC5B,GAAIA,EAAQM,IAAMxF,KAAK4F,UAAUlF,eAAewE,EAAQM,IAAK,CACzD,IAAIK,EAAU7F,KAAK4F,UAAUV,EAAQM,IACrCK,EAAQC,OAAOZ,EAAQa,OACvBC,aAAaH,EAAQxF,gBACdL,KAAK4F,UAAUV,EAAQM,UAE/B,GAAI/D,QAAQuB,IAAIkC,EAAS,WACxBA,EAAQM,IAAMxF,KAAK4F,UAAUlF,eAAewE,EAAQM,IAAK,CACzD,IAAIK,EAAU7F,KAAK4F,UAAUV,EAAQM,IACjCE,EAASR,EAAQQ,OACrB,GAAIA,GAA4B,iBAAXA,GAAuBjE,QAAQuB,IAAI0C,EAAQ,WAAY,CACxE,MAAM9C,EAAO5C,KACPc,EAAW4E,EAAO,WAClBO,EAAyC,CAC3CrG,IAAIsD,EAAQC,EAAMnC,GACd,MAAMoC,EAAQC,OAAOF,GACf+C,EAAWhD,EAAOiD,WAAa,GAAGjD,EAAOiD,cAAc/C,IAAUA,EAEvE,OADAR,EAAKwD,KAAK,qBAAsB,CAACtF,EAAUoF,EAAUlF,KAC9C,GAEXpB,IAAIsD,EAAQC,GAER,MAAMC,EAAQC,OAAOF,GACrB,GAAc,SAAVC,GAA0C,OAAtBA,EAAMf,MAAM,EAAG,GAGvC,OAAIZ,QAAQuB,IAAIE,EAAQC,GACbD,EAAOC,IAEb1B,QAAQuB,IAAIE,EAAOmD,QAASlD,KAC7BD,EAAOmD,QAAQlD,GAAQ,IAAIF,MACvBF,OAAOuD,OAAO,OAAU,CACpBH,WAAYjD,EAAOiD,WAAa,GAAGjD,EAAOiD,cAAc/C,IAAUA,EAClEiD,QAAS,KAEbJ,IAGD/C,EAAOmD,QAAQlD,KAE1Bb,MAAK,CAACY,EAAQK,EAAG/C,IACNoC,EAAKwD,KAAK,uBAAwB,CAACtF,EAAUoC,EAAOiD,WAAY3F,KAIzE6F,EAAU,GAChBX,EAAS,IAAIzC,MACTF,OAAOuD,OAAO,OAAU,CACpBD,QAAAA,EACAE,SAAQ,KACJxD,OAAOyD,KAAKH,GAASI,QAAStD,UAAgBkD,EAAQlD,IAC/CP,EAAKwD,KAAK,yBAA0B,CAACtF,KAEhD4F,KAAI,IACO9D,EAAKwD,KAAK,qBAAsB,CAACtF,MAGhDmF,GAGRJ,EAAQhF,QAAQ6E,GAChBM,aAAaH,EAAQxF,gBACdL,KAAK4F,UAAUV,EAAQM,IAItC,OAAO5E,QAAQC,UA7HXb,KAAKmF,UAAU,IAAIzF,EAAS,eAAgB,QAgI7CE,WAAW8F,EAAaF,GAC3B,MAAMmB,EAAY,CACdvB,QAAS,MACTM,OAAQA,GAAU,MAItB,OAFIF,IAAImB,EAAKnB,GAAKA,GAClBxF,KAAKE,KAAKyG,GACH3G,KAGJJ,UAAUgC,EAAa4D,GAC1B,MAAMmB,EAAY,CACdvB,QAAS,MACTW,MAAO,CACHjG,KAAM8B,EAAE9B,KACRD,QAAS+B,EAAE/B,UAKnB,OAFI2F,IAAImB,EAAKnB,GAAKA,GAClBxF,KAAKE,KAAKyG,GACH3G,KAGJJ,OAAO4E,EAAgBhE,EAAc,IACxCA,EAASR,KAAK4G,iBAAiBpG,GAC/BR,KAAKE,KAAK,CACNkF,QAAS,MACTZ,OAAAA,EACAhE,OAAAA,IAIDZ,KAAK4E,EAAgBhE,EAAc,IACtCA,EAASR,KAAK4G,iBAAiBpG,GAC/B,IAAIoC,EAAO5C,KACX,OAAO,IAAIY,QAAQ,CAACC,EAASiF,KACzB,IAAIN,EAAK/F,IACLkH,EAAO,CACPnB,GAAAA,EACAJ,QAAS,MACTZ,OAAAA,EACAhE,OAAAA,GAGJoC,EAAK1C,KAAKyG,GAEV/D,EAAKgD,UAAUJ,GAAM,CACjB3E,QAAAA,EACAiF,OAAAA,EACAzF,QAASwG,WAAW,YACTjE,EAAKgD,UAAUJ,GACtBM,EAAO,IAAIpG,EAAS,QAAQ8E,aAAmB,SAChD5B,EAAKxC,SAASC,YAKtBT,KAAK4E,EAAgBI,GACxB,OAAO5E,KAAKM,GAAGkE,EAAQI,GAAU,GAG9BhF,GAAG4E,EAAyBI,EAAoBD,GAAO,GAS1D,MARsB,iBAAXH,EACPxE,KAAK6E,UAAUT,KAAK,CAChBY,QAASR,EACTI,SAAAA,IAGJ5E,KAAKyE,iBAAiBD,GAAU,CAAEI,SAAAA,EAAUD,KAAAA,GAEzC3E,KAGJJ,IAAI4E,GACP,GAAsB,iBAAXA,EAAqB,CAC5B,IAAK,IAAI7B,KAAO3C,KAAKyE,iBACQ,MAArB9B,EAAIoC,MAAMP,WAAwBxE,KAAKyE,iBAAiB9B,GAGhE,IAAImE,EAAMtC,EAAOuC,WACjB/G,KAAK6E,UAAY7E,KAAK6E,UAAUmC,OAAQxF,GAAMA,EAAEwD,QAAQ+B,aAAeD,eAEhE9G,KAAKyE,iBAAiBD,GAEjC,OAAOxE,MAvZGC,QAAQP,EC7C1BqD,OAAOuD,OAAOrG,EAAK,CACf8D,SAAW/C,GAAUiG,OAAOlD,SAAS/C,GACrCgD,aAAehD,GAAkBA,EAAM+F,SAAS,UAChDnD,aAAesD,GAAcD,OAAOE,KAAKD,EAAG"}